\def\welldepthAfox{0.75}
\def\welldepthBfox{1.25}
\def\welldepthCfox{1.5}

\newcommand{\stopper}[1]{
\filldraw[line width=0, isolationoxide] (#1,2.0) -- (#1+0.75,2.0) -- (#1+0.75,2.75);
\fill[isolationoxide] (#1+0.75,2.0) rectangle (#1+1.25,2.75);
\filldraw[line width=0, isolationoxide] (#1+1.25,2.75) -- (#1+1.25,2.0) -- (#1+2.0,2.0);
}

\newcommand{\bjtstopper}[1]{
\filldraw[line width=0, isolationoxide] (#1,2.0) -- (#1+0.25,2.0) -- (#1+0.25,2.75);
\fill[isolationoxide] (#1+0.25,2.0) rectangle (#1+0.5,2.75);
\filldraw[line width=0, isolationoxide] (#1+0.5,2.75) -- (#1+0.5,2.0) -- (#1+0.75,2.0);
}

% oxide
\fill[isolationoxide] (0,1.25) rectangle (55.0,2.0);

\fill[isolationoxide] (0,2.0) rectangle (0.75,2.75);
\filldraw[line width=0, isolationoxide] (0.75,2.75) -- (0.75,2.0) -- (1.5,2.0);

%separates n+ from p+
\stopper{2.5}
\stopper{8.0}

%separates n+ from p+
\stopper{13.5}

\stopper{16.5}
\stopper{17.0}

\stopper{20.0}

\stopper{24.5}
\stopper{25.0}

\bjtstopper{27.75}
\bjtstopper{29.0}
\bjtstopper{30.5}
\bjtstopper{31.75}

\stopper{33.5}
\stopper{33.75}

\bjtstopper{36.5}
\bjtstopper{37.75}
\bjtstopper{39.0}
\bjtstopper{40.25}

\filldraw[line width=0, isolationoxide] (41.75,2.0) -- (42.5,2.0) -- (42.5,2.75);
\fill[isolationoxide] (42.5,2.0) rectangle (55.0,2.75);

\input{tikz_process_steps/sti.a.tex}

% substrate
\fill[substrate] (0,0) rectangle (55,1.25);
\node at (2,0.5) {Silicon substrate};

% normal wells
\shade[upper left = nwell, upper right = nwell, lower right = substrate, lower left = substrate,] (1.25,\welldepthAfox) rectangle (8.25,2.0);
\shade[upper left = pwell, upper right = pwell, lower right = substrate, lower left = substrate,] (9.75,\welldepthAfox) rectangle (16.75,2.0);
\shade[upper left = nwell, upper right = nwell, lower right = substrate, lower left = substrate,] (18.25,\welldepthAfox) rectangle (25.25,2.0);
\shade[upper left = nwell, upper right = nwell, lower right = substrate, lower left = substrate,] (26.75,\welldepthAfox) rectangle (33.75,2.0);
\shade[upper left = nwell, upper right = nwell, lower right = substrate, lower left = substrate,] (35.25,\welldepthAfox) rectangle (42.25,2.0);

% p base
\shade[upper left = pbase, upper right = pbase, lower right = nwell, lower left = nwell,] (18.5,\welldepthBfox) rectangle (25.0,2.0);

% npn - pbase
\shade[upper left = pbase, upper right = pbase, lower right = nwell, lower left = nwell,] (28.25,\welldepthBfox) rectangle (32.0,2.0);

% pnp emitter and collector ring
\shade[upper left = pbase, upper right = pbase, lower right = nwell, lower left = nwell,] (35.5,\welldepthBfox) rectangle (37.0,2.0);
\shade[upper left = pbase, upper right = pbase, lower right = nwell, lower left = nwell,] (38.0,\welldepthBfox) rectangle (39.5,2.0);
\shade[upper left = pbase, upper right = pbase, lower right = nwell, lower left = nwell,] (40.5,\welldepthBfox) rectangle (42.0,2.0);

% n base for SONOS
\shade[upper left = nbase, upper right = nbase, lower right = pbase, lower left = pbase,] (18.75,\welldepthCfox) rectangle (24.75,2.0);

% n base for NPN emitter
\shade[upper left = nbase, upper right = nbase, lower right = pbase, lower left = pbase,] (29.5,\welldepthCfox) rectangle (30.75,2.0);

